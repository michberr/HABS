mapfile = "other/best_metadata.csv"
setwd("~/chabs/miseq_may2015/analysis/")
r<-read.csv(mapfile)
View(r)
d<-r$Date
g<-gsub("5/","05/",d)
g
g<-gsub("6/","06/",g)
g
g<-gsub("7/","07/",g)
library(phyloseq)
library(Biostrings)
library(ggplot2)
library(vegan)
library(plyr)
library(scales)
library(grid)
library(reshape2)
library(gridExtra)
library(RColorBrewer)
sharedfile = "mothur/allhabs.shared"
source("habs_functions_cray.R")
mothurdata = import_mothur(mothur_shared_file = sharedfile,
mothur_constaxonomy_file = taxfile)
getwd()
sharedfile = "mothur/allhabs.shared"
taxfile = "mothur/allhabs.taxonomy"
mapfile = "other/best_metadata.csv"
mothurdata = import_mothur(mothur_shared_file = sharedfile,
mothur_constaxonomy_file = taxfile)
# Add the OTU number as a column in the taxonomy file
tax_table(mothurdata) <- cbind(tax_table(mothurdata),
row.names(tax_table(mothurdata)))
# Rename the taxonomy columns
colnames(tax_table(mothurdata)) <- c("Kingdom", "Phylum", "Class", "Order",
"Family", "Genus", "Species")
map <- read.csv(mapfile)
map <- sample_data(map)
rownames(map) <- map$SampleID
moth_merge = merge_phyloseq(mothurdata, map)
moth_good <- subset_samples(moth_merge,Type == "sample")
moth_good <- prune_taxa(taxa_sums(moth_good) > 0, moth_good)
moth_good <- subset_taxa(moth_good, Kingdom == "Bacteria")
moth_good <- subset_taxa(moth_good, Class != "Chloroplast")
moth_good <- subset_taxa(moth_good, Family != "mitochondria")
source("habs_functions.R")
